var Keyboard=function(){function e(t,i,a){var s=this;this._elementHTML="PGRpdiBjbGFzcz0ia2Itcm93Ij48ZGl2IGNsYXNzPSJrYi1rZXkgY2hhciI+PC9kaXY+PGRpdiBjbGFzcz0ia2Ita2V5IGNoYXIiPjwvZGl2PjxkaXYgY2xhc3M9ImtiLWtleSBjaGFyIj48L2Rpdj48ZGl2IGNsYXNzPSJrYi1rZXkgY2hhciI+PC9kaXY+PGRpdiBjbGFzcz0ia2Ita2V5IGNoYXIiPjwvZGl2PjxkaXYgY2xhc3M9ImtiLWtleSBjaGFyIj48L2Rpdj48ZGl2IGNsYXNzPSJrYi1rZXkgY2hhciI+PC9kaXY+PGRpdiBjbGFzcz0ia2Ita2V5IGNoYXIiPjwvZGl2PjxkaXYgY2xhc3M9ImtiLWtleSBjaGFyIj48L2Rpdj48ZGl2IGNsYXNzPSJrYi1rZXkgY2hhciI+PC9kaXY+PGRpdiBjbGFzcz0ia2Ita2V5IGtiLW90aGVyIiBkYXRhLWhhbmRsZXI9ImJhY2tzcGFjZSI+QmFjazwvZGl2PjwvZGl2PjxkaXYgY2xhc3M9ImtiLXJvdyI+IDxkaXYgY2xhc3M9ImtiLWtleSBjaGFyIj48L2Rpdj48ZGl2IGNsYXNzPSJrYi1rZXkgY2hhciI+PC9kaXY+PGRpdiBjbGFzcz0ia2Ita2V5IGNoYXIiPjwvZGl2PjxkaXYgY2xhc3M9ImtiLWtleSBjaGFyIj48L2Rpdj48ZGl2IGNsYXNzPSJrYi1rZXkgY2hhciI+PC9kaXY+PGRpdiBjbGFzcz0ia2Ita2V5IGNoYXIiPjwvZGl2PjxkaXYgY2xhc3M9ImtiLWtleSBjaGFyIj48L2Rpdj48ZGl2IGNsYXNzPSJrYi1rZXkgY2hhciI+PC9kaXY+PGRpdiBjbGFzcz0ia2Ita2V5IGNoYXIiPjwvZGl2PjxkaXYgY2xhc3M9ImtiLWtleSBrYi1vdGhlciIgZGF0YS1oYW5kbGVyPSJlbnRlciI+RW50ZXI8L2Rpdj48L2Rpdj48ZGl2IGNsYXNzPSJrYi1yb3ciPiA8ZGl2IGNsYXNzPSJrYi1rZXkga2Itb3RoZXIiIGRhdGEtaGFuZGxlcj0ic2hpZnQiPlNoaWZ0PC9kaXY+PGRpdiBjbGFzcz0ia2Ita2V5IGNoYXIiPjwvZGl2PjxkaXYgY2xhc3M9ImtiLWtleSBjaGFyIj48L2Rpdj48ZGl2IGNsYXNzPSJrYi1rZXkgY2hhciI+PC9kaXY+PGRpdiBjbGFzcz0ia2Ita2V5IGNoYXIiPjwvZGl2PjxkaXYgY2xhc3M9ImtiLWtleSBjaGFyIj48L2Rpdj48ZGl2IGNsYXNzPSJrYi1rZXkgY2hhciI+PC9kaXY+PGRpdiBjbGFzcz0ia2Ita2V5IGNoYXIiPjwvZGl2PjwvZGl2PjxkaXYgY2xhc3M9ImtiLXJvdyI+IDxkaXYgY2xhc3M9ImtiLWtleSBrYi1vdGhlciIgZGF0YS1oYW5kbGVyPSJudW1wYWQiPj8xMjM8L2Rpdj48ZGl2IGNsYXNzPSJrYi1rZXkga2Itb3RoZXIiPiw8L2Rpdj48ZGl2IGNsYXNzPSJrYi1rZXkga2Itb3RoZXIga2Itc3BhY2ViYXIiIGRhdGEtaGFuZGxlcj0ic3BhY2UiIGRhdGEtYmluZD0iZGlzcGxheU5hbWU6aW5uZXJUZXh0Ij5TcGFjZTwvZGl2PjxkaXYgY2xhc3M9ImtiLWtleSBrYi1vdGhlciI+LjwvZGl2PjxkaXYgY2xhc3M9ImtiLWtleSBrYi1vdGhlciIgZGF0YS1oYW5kbGVyPSJzd2l0Y2giPlN3aXRjaDwvZGl2PjwvZGl2Pg==";var r=document.createElement("div");r.id="kb-base",r.classList.add("kb-base"),r.innerHTML=window.atob(this._elementHTML),this._editorElement=t,this._keyElements=r.querySelectorAll(".char"),this._cmdKeys=r.querySelectorAll(".kb-key[data-bind]"),this._setKeymap(e._keymaps[0],!1,!1),this._languages=a,this._languageIndex=0;var n=function(e){if(e.target!==e.currentTarget){var t=e.target;if("touchstart"==e.type||"mousedown"==e.type){e.preventDefault(),t.classList.add("kb-pressed");var i=t.getAttribute("data-handler");i&&"backspace"==i&&(s._isKeyPressed=!0,s._setPressedInterval(300,i))}else if("touchend"==e.type||"mouseup"==e.type){t.classList.remove("kb-pressed"),s._isKeyPressed&&(clearInterval(s._pressedHandle),s._isKeyPressed=!1,s._pressedHandle=null);var a=t.getAttribute("data-handler"),r=a?a:t.innerText;s._handleKey(r)}}e.stopPropagation()},l="ontouchstart"in window;l?(r.addEventListener("touchstart",n,!1),r.addEventListener("touchend",n,!1)):(r.addEventListener("mousedown",n,!1),r.addEventListener("mouseup",n,!1)),document.body.appendChild(r),this._baseElement=r,i&&this._editorElement.style.setProperty("white-space","pre-wrap"),this._editorElement.focus()}return e.prototype._populate=function(e,t,i){var a;a=t?e.keys.numbers:i?e.keys.uppercase:e.keys.lowercase;var s=e.custom_styles,r=e.font,n=0,l=0;for(n=0;n<a.length;n++){var o=a[l++],h=this._keyElements[n];if(h.hasAttribute("style")&&h.removeAttribute("style"),s&&s.length>0){var d=s.filter(function(e){return e["char"]==o})[0];for(var c in d)"char"!=c&&h.style.setProperty(c,d[c])}r&&(h.style.fontFamily=r),h.innerHTML=o}},e.prototype._setKeymap=function(e,t,i){this._populate(e,t,i),this._isNumberPad=t,this._isUpperCase=i,this._keyMap=e;for(var a=0;a<this._cmdKeys.length;a++){var s=this._cmdKeys[a],r=s.getAttribute("data-bind").split(":"),n=r[0],l=r[1];s[l]=this._keyMap[n]}},e.prototype._getCursor=function(){var e,t;return e=window.getSelection(),e.getRangeAt&&e.rangeCount&&(t=e.getRangeAt(0)),t},e.prototype._setCursor=function(e){var t=window.getSelection();t.removeAllRanges(),t.addRange(e)},e.prototype._isElementValid=function(e){return e===this._editorElement?!0:e.parentNode&&this._isElementValid(e.parentNode)},e.prototype._insertAtCursor=function(e,t,i){var a,s=this._getCursor();this._isElementValid(s.startContainer)&&(t?a=document.createTextNode(e):(a=document.createElement(e),a.innerHTML=i),s.insertNode(a),s.setStartAfter(a),this._setCursor(s),this._editorElement.normalize())},e.prototype._removeAtCursor=function(){var e=this._getCursor();this._isElementValid(e.startContainer)&&(e.collapsed&&e.setStart(e.startContainer,e.startOffset-1),e.deleteContents(),this._setCursor(e))},e.prototype._handleKey=function(e){switch(e){case"shift":this.SwitchCase();break;case"numpad":this.ToggleNumpad();break;case"switch":this.SwitchLanguage();break;case"enter":this._insertAtCursor("\n",!0,null);break;case"space":this._insertAtCursor("Â ",!0,null);break;case"backspace":this._removeAtCursor();break;default:this._insertAtCursor(e,!0,null),this._isUpperCase&&this.SwitchCase()}},e.prototype.SwitchCase=function(){this._isUpperCase?this._setKeymap(this._keyMap,!1,!1):this._setKeymap(this._keyMap,!1,!0)},e.prototype.ToggleNumpad=function(){this._isNumberPad?this._setKeymap(this._keyMap,!1,!1):this._setKeymap(this._keyMap,!0,!1)},e.prototype.SetLanguage=function(t){var i=e._keymaps.filter(function(e){return e.lang==t})[0];this._setKeymap(i,!1,!1)},e.prototype.SwitchLanguage=function(){this._languageIndex++,this._languageIndex==this._languages.length&&(this._languageIndex=0),this.SetLanguage(this._languages[this._languageIndex])},e.prototype.Hide=function(){this._baseElement.classList.add("kb-hidden")},e.prototype.Show=function(){this._baseElement.classList.remove("kb-hidden")},e.AddKeymap=function(e){this._keymaps.push(e)},e.RemoveKeymap=function(e){var t=this._keymaps.indexOf(e);t>-1&&this._keymaps.splice(t,1)},e.prototype._setPressedInterval=function(e,t){var i=this,a=e;clearInterval(this._pressedHandle),this._pressedHandle=setInterval(function(){i._isKeyPressed&&(a=Math.min(Math.abs(a-50),100),i._handleKey(t),i._setPressedInterval(a,t))},a)},e._keymaps=[{name:"default",lang:"english",displayName:"English",direction:"ltr",keys:{lowercase:["q","w","e","r","t","y","u","i","o","p","a","s","d","f","g","h","j","k","l","z","x","c","v","b","n","m"],uppercase:["Q","W","E","R","T","Y","U","I","O","P","A","S","D","F","G","H","J","K","L","Z","X","C","V","B","N","M"],numbers:["1","2","3","4","5","6","7","8","9","0","@","#","$","%","&","-","+","(",")","*",'"',"'",":",";","!","?"]},font:"Roboto",custom_styles:[]}],e}();