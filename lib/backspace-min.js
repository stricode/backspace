var Keyboard=function(){function t(e,i,a){var s=this;this._elementHTML="PGRpdiBjbGFzcz0ia2Itcm93Ij48ZGl2IGNsYXNzPSJrYi1rZXkgY2hhciI+PC9kaXY+PGRpdiBjbGFzcz0ia2Ita2V5IGNoYXIiPjwvZGl2PjxkaXYgY2xhc3M9ImtiLWtleSBjaGFyIj48L2Rpdj48ZGl2IGNsYXNzPSJrYi1rZXkgY2hhciI+PC9kaXY+PGRpdiBjbGFzcz0ia2Ita2V5IGNoYXIiPjwvZGl2PjxkaXYgY2xhc3M9ImtiLWtleSBjaGFyIj48L2Rpdj48ZGl2IGNsYXNzPSJrYi1rZXkgY2hhciI+PC9kaXY+PGRpdiBjbGFzcz0ia2Ita2V5IGNoYXIiPjwvZGl2PjxkaXYgY2xhc3M9ImtiLWtleSBjaGFyIj48L2Rpdj48ZGl2IGNsYXNzPSJrYi1rZXkgY2hhciI+PC9kaXY+PGRpdiBjbGFzcz0ia2Ita2V5IGtiLW90aGVyIiBkYXRhLWhhbmRsZXI9ImJhY2tzcGFjZSI+QmFjazwvZGl2PjwvZGl2PjxkaXYgY2xhc3M9ImtiLXJvdyI+IDxkaXYgY2xhc3M9ImtiLWtleSBjaGFyIj48L2Rpdj48ZGl2IGNsYXNzPSJrYi1rZXkgY2hhciI+PC9kaXY+PGRpdiBjbGFzcz0ia2Ita2V5IGNoYXIiPjwvZGl2PjxkaXYgY2xhc3M9ImtiLWtleSBjaGFyIj48L2Rpdj48ZGl2IGNsYXNzPSJrYi1rZXkgY2hhciI+PC9kaXY+PGRpdiBjbGFzcz0ia2Ita2V5IGNoYXIiPjwvZGl2PjxkaXYgY2xhc3M9ImtiLWtleSBjaGFyIj48L2Rpdj48ZGl2IGNsYXNzPSJrYi1rZXkgY2hhciI+PC9kaXY+PGRpdiBjbGFzcz0ia2Ita2V5IGNoYXIiPjwvZGl2PjxkaXYgY2xhc3M9ImtiLWtleSBrYi1vdGhlciIgZGF0YS1oYW5kbGVyPSJlbnRlciI+RW50ZXI8L2Rpdj48L2Rpdj48ZGl2IGNsYXNzPSJrYi1yb3ciPiA8ZGl2IGNsYXNzPSJrYi1rZXkga2Itb3RoZXIiIGRhdGEtaGFuZGxlcj0ic2hpZnQiPlNoaWZ0PC9kaXY+PGRpdiBjbGFzcz0ia2Ita2V5IGNoYXIiPjwvZGl2PjxkaXYgY2xhc3M9ImtiLWtleSBjaGFyIj48L2Rpdj48ZGl2IGNsYXNzPSJrYi1rZXkgY2hhciI+PC9kaXY+PGRpdiBjbGFzcz0ia2Ita2V5IGNoYXIiPjwvZGl2PjxkaXYgY2xhc3M9ImtiLWtleSBjaGFyIj48L2Rpdj48ZGl2IGNsYXNzPSJrYi1rZXkgY2hhciI+PC9kaXY+PGRpdiBjbGFzcz0ia2Ita2V5IGNoYXIiPjwvZGl2PjwvZGl2PjxkaXYgY2xhc3M9ImtiLXJvdyI+IDxkaXYgY2xhc3M9ImtiLWtleSBrYi1vdGhlciIgZGF0YS1oYW5kbGVyPSJudW1wYWQiPj8xMjM8L2Rpdj48ZGl2IGNsYXNzPSJrYi1rZXkga2Itb3RoZXIiPiw8L2Rpdj48ZGl2IGNsYXNzPSJrYi1rZXkga2Itb3RoZXIga2Itc3BhY2ViYXIiIGRhdGEtaGFuZGxlcj0ic3BhY2UiIGRhdGEtYmluZD0iZGlzcGxheU5hbWU6aW5uZXJUZXh0Ij5TcGFjZTwvZGl2PjxkaXYgY2xhc3M9ImtiLWtleSBrYi1vdGhlciI+LjwvZGl2PjxkaXYgY2xhc3M9ImtiLWtleSBrYi1vdGhlciIgZGF0YS1oYW5kbGVyPSJzd2l0Y2giPlN3aXRjaDwvZGl2PjwvZGl2Pg==";var r=document.createElement("div");r.id="kb-base",r.classList.add("kb-base"),r.innerHTML=window.atob(this._elementHTML),this._editorElement=e,this._keyElements=r.querySelectorAll(".char"),this._cmdKeys=r.querySelectorAll(".kb-key[data-bind]"),this._setKeymap(t._keymaps[0],!1,!1),this._languages=a,this._languageIndex=0;var n=function(t){if(t.target!==t.currentTarget){var e=t.target;if("touchstart"==t.type||"mousedown"==t.type)t.preventDefault(),e.classList.add("kb-pressed");else if("touchend"==t.type||"mouseup"==t.type){e.classList.remove("kb-pressed");var i=e.getAttribute("data-handler"),a=i?i:e.innerText;s._handleKey(a)}}t.stopPropagation()},o="ontouchstart"in window;o?(r.addEventListener("touchstart",n,!1),r.addEventListener("touchend",n,!1)):(r.addEventListener("mousedown",n,!1),r.addEventListener("mouseup",n,!1)),document.body.appendChild(r),this._baseElement=r,i&&this._editorElement.style.setProperty("white-space","pre-wrap"),this._editorElement.focus()}return t.prototype._populate=function(t,e,i){var a;a=e?t.keys.numbers:i?t.keys.uppercase:t.keys.lowercase;var s=t.custom_styles,r=t.font,n=0,o=0;for(n=0;n<a.length;n++){var l=a[o++],h=this._keyElements[n];if(h.hasAttribute("style")&&h.removeAttribute("style"),s&&s.length>0){var c=s.filter(function(t){return t["char"]==l})[0];for(var d in c)"char"!=d&&h.style.setProperty(d,c[d])}r&&(h.style.fontFamily=r),h.innerHTML=l}},t.prototype._setKeymap=function(t,e,i){this._populate(t,e,i),this._isNumberPad=e,this._isUpperCase=i,this._keyMap=t;for(var a=0;a<this._cmdKeys.length;a++){var s=this._cmdKeys[a],r=s.getAttribute("data-bind").split(":"),n=r[0],o=r[1];s[o]=this._keyMap[n]}},t.prototype._getCursor=function(){var t,e;return t=window.getSelection(),t.getRangeAt&&t.rangeCount&&(e=t.getRangeAt(0)),e},t.prototype._setCursor=function(t){var e=window.getSelection();e.removeAllRanges(),e.addRange(t)},t.prototype._isElementValid=function(t){return t===this._editorElement?!0:t.parentNode&&this._isElementValid(t.parentNode)},t.prototype._insertAtCursor=function(t,e,i){var a,s=this._getCursor();this._isElementValid(s.startContainer)&&(e?a=document.createTextNode(t):(a=document.createElement(t),a.innerHTML=i),s.insertNode(a),s.setStartAfter(a),this._setCursor(s),this._editorElement.normalize())},t.prototype._removeAtCursor=function(){var t=this._getCursor();this._isElementValid(t.startContainer)&&(t.collapsed&&t.setStart(t.startContainer,t.startOffset-1),t.deleteContents(),this._setCursor(t))},t.prototype._handleKey=function(t){switch(t){case"shift":this.SwitchCase();break;case"numpad":this.ToggleNumpad();break;case"switch":this.SwitchLanguage();break;case"enter":this._insertAtCursor("\n",!0,null);break;case"space":this._insertAtCursor("Â ",!0,null);break;case"backspace":this._removeAtCursor();break;default:this._insertAtCursor(t,!0,null)}},t.prototype.SwitchCase=function(){this._isUpperCase?this._setKeymap(this._keyMap,!1,!1):this._setKeymap(this._keyMap,!1,!0)},t.prototype.ToggleNumpad=function(){this._isNumberPad?this._setKeymap(this._keyMap,!1,!1):this._setKeymap(this._keyMap,!0,!1)},t.prototype.SetLanguage=function(e){var i=t._keymaps.filter(function(t){return t.lang==e})[0];this._setKeymap(i,!1,!1)},t.prototype.SwitchLanguage=function(){this._languageIndex++,this._languageIndex==this._languages.length&&(this._languageIndex=0),this.SetLanguage(this._languages[this._languageIndex])},t.prototype.Hide=function(){this._baseElement.classList.add("kb-hidden")},t.prototype.Show=function(){this._baseElement.classList.remove("kb-hidden")},t.AddKeymap=function(t){this._keymaps.push(t)},t.RemoveKeymap=function(t){var e=this._keymaps.indexOf(t);e>-1&&this._keymaps.splice(e,1)},t._keymaps=[{name:"default",lang:"english",displayName:"English",direction:"ltr",keys:{lowercase:["q","w","e","r","t","y","u","i","o","p","a","s","d","f","g","h","j","k","l","z","x","c","v","b","n","m"],uppercase:["Q","W","E","R","T","Y","U","I","O","P","A","S","D","F","G","H","J","K","L","Z","X","C","V","B","N","M"],numbers:["1","2","3","4","5","6","7","8","9","0","@","#","$","%","&","-","+","(",")","*",'"',"'",":",";","!","?"]},font:"Roboto",custom_styles:[]}],t}();